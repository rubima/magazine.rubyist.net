---
layout: post
title: RegionalRubyKaigi レポート (xx) 東京Ruby会議12
short_title: RegionalRubyKaigi レポート (xx) 東京Ruby会議12
post_author: 東京Ruby会議12 実行委員会
tags: regionalRubyKaigi
created_on: 2025-01-27
---

{% include base.html %}

## RegionalRubyKaigi レポート (xx) 東京Ruby会議12

2016年の東京Ruby会議11から9年、東京Ruby会議が帰ってきました。おかえりなさい。始動させたのはオーガナイザーのおしょうゆさん、それからコアメンバーの皆さんです。今回は神奈川県は横浜市鶴見区、まあ大体東京に収まる範囲の「東京」で開催されました。

<img src="{{base}}{{site.baseurl}}/images/0065-TokyoRubyKaigi12Report/welcome.jpg" width="300px" alt="参加者を迎えるウェルカムボード">

このレポートでは、当日のトークのレポートや感想、それからトーク外、いわゆる「廊下」の様子や、スポンサーブースの様子、当日まで秘められていたオーガナイザーたちの「おもてなし」を紹介します。わたしは廊下が好きなので廊下のお話をします。それではどうぞ、追体験の旅へいってらっしゃい。

(sakahukamaki)

## キーノート

## John Hawthorn『Scaling Ruby @ GitHub』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


## Kohei Suzuki『Ruby と Rust と私』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


## セッション

### Keynote: 『Scaling Ruby @ GitHub』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。


(your name)

### 前田 修吾『Ruby製テキストエディタでの生活』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


### ぺん！『全てが同期する! Railsとフロントエンドのシームレスな連携の再考』

* 録画: https://example.com/

コラボレーションツール、チャットやオンライン授業など、複数のWebフロントエンドがリアルタイムに協調動作する必要のあるユースケースで、それらをいかにして同期させるかというテーマでした。既存のリアルタイムデータベースを使用するのではなく、Active Recordを活用すべく、RailsとReactの組み合わせで実現する方法について話されました。

バックエンドからフロントエンドに情報を送る際に重要なのは「何をどう送るか」というイベントの設計です。特にモデル間に関連がある場合には扱いが複雑で、場当たり的なイベント定義をしていくとモデル数の増加とともに破綻してしまいます。

ユースケースの分析から、データフローを一方向に制約し、「木構造を丸ごとリアルタイムに同期したい」という問題に帰着させ、それをどう実現するかという議論に移っていきます。Railsのモデルとこの木構造は単純には対応しないものの、画面ごとにデータの親子関係を考えることができ、それを木構造として扱っています。具体的な通知の実装方式として「どの単位でサブスクライブするか」「更新の事実だけを通知するのか内容も通知するのか」という2つの軸で整理し、メリット・デメリットが議論されました。

これらを実現するための一式を含むgemとして[ArSync](https://github.com/tompng/ar_sync)を開発されているとのことです。発表は「JavaScript / TypeScript / ruby.wasmとRailsの組み合わせにはあまり試されていない可能性がまだまだありそう」「僕らはRubyのポテンシャルをもっと引き出せるはず」とのメッセージで締めくくられました。

私はリアルタイムWebアプリケーションが大好物で、複数のスタックで実装した経験もあって、とても興味深く聞きました。ただ、複数のモデルが複雑に関連するようなものはあまり経験がありませんでした。発表では親が変わるケースや複数あるケースにも言及されており、これは大変そう…という気持ちになりました。現代Web技術とRuby / Railsの新たな可能性、気になります。

(darashi)


### ryopeko『functionalなアプローチで動的要素を排除する』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


### tokujiros『ゼロからの、2Dレトロゲームエンジンの作り方』

* 録画: https://example.com/

tokujirosさんの発表では、Rubyアソシエーション開発助成金にも採択された[Reight](https://github.com/xord/reight)の内部実装と利用方法について紹介されました！ReightはRubyで実装されたレトロゲームエンジンで、Reightをインストールして起動することでゲームを作るための統合開発環境が立ち上がります。統合開発環境では、ゲームに表示させるキャラクターやコインなどをドット絵で作ったり、それをマップ上に配置したりといったゲームを作るための作業と実際のプレイができます。ゲーム中のキャラクターの操作や当たり判定などはgame.rbにRubyのコードで実装します。発表中に使われたコードが[reight-examples](https://github.com/xord/reight-examples)に上がっていて、インストール後すぐに試すことができるので是非！

発表の中ではReightの技術スタックが紹介されていて、コンピュータグラフィックのライブラリであるOpenGLを抽象化してるレイヤーの実装や統合開発環境のツールキット、ゲームを描画するコードを各部分のProcessing 互換 APIレイヤーなどなど、Reightを構成している各技術について知ることができました。私が前日の前夜祭でクリエイティブコーディングのワークショップに参加していたこともあり、Processing 互換 APIレイヤーの話を聞いてる時には「おー、同じようにこうやって描画するのか！」と東京Ruby会議の中での繋がりを感じられてよかったです。

普段はゲームはする専門ですが、発表を聞いてゲームを作る方の楽しみや、それが普段使い慣れてるRubyのコードでできることの良さを知り、自分もRubyで趣味の幅を広げたいな〜を感じた発表でした！

(三谷 昌平)


### yumu『Ruby×AWSで作る動画変換システム』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


### moznion『simple組み合わせ村から大都会Railsにやってきた俺は』

* 録画: https://example.com/

moznion さんの発表内容は、Rails と Perl の違いを比較しながら、それぞれの特徴をもとにした開発スタイルに焦点を当てたものでした。
それらの違いを「Simple vs Easy」の構図で語っていた点が印象的です。

例えば、Rails は、規約があるフルスタックなフレームワークで Easy に作れる仕組みがある一方、隠蔽されている部分が複雑です。
一方で、Perl などの Simple 組み合わせでは、必要なものだけを組み込めたり、自分たちのベストプラクティスを作れたりする柔軟性があります。
とはいえ、Simple と Easy は完全に相反するものではないという点が重要なポイントです。

Rails と Perl などの Simple 組み合わせは、それぞれが Easy と Simple を両立しています。
Rails は、作るための仕組みは Easy ですが、ビジネスロジックは Simple に実現できます。
一方、Perl などの Simple 組み合わせは、最大公約数的な Easy ではなく、ドメインに特化した Easy を Simple とともに得られます。

私は Simple 組み合わせ村の経験はあまりありませんが、自社のドメイン知識をベースにシステムを考えていくことで、確かにドメインに特化した Easy と Simple が得られるのだろうと感じました。
逆に Rails は "Rails Way" という言葉があるように、最大公約数的な Easy と Simple を目指しているのだなという気づきも得られました。

特に印象的だったのは、「Simple 組み合わせでは自分たちに最適化したベストプラクティスを作れるので、レールを外れることを恐れなくて良くなる」という部分です。
Rails を書いている身としては、レールに沿っているかを気にする場面があるので、確かにと共感しました。
レールに沿ったものがベストプラクティスであるため、ベストプラクティスを考える手間はある程度省けており、ドメインロジックの実現に集中できるということなのだと思いました。

改めて Rails の立ち位置を考える機会となった発表でした！

[The Rails Doctrine.](https://rubyonrails.org/doctrine) もこちらの発表内容と合わせて読めるとより楽しめるかもしれませんね。

(dak2)


### Hiromi Ogawa『Writing PDFs in Ruby DSL』

* 録画: https://example.com/

Ogawa さんは、Ruby DSL を使って PDF を生成するという内容でした。

PDF の仕様の話をすると、ヘッダー / ボディー / クロスリファレンステーブル / トレイラー の4つで構成されているようです。
その内、ボディー部のオブジェクトの構造は下記のようになっています。（一部省略）

```
1 0 obj << /Type /Catalog /Pages 2 0 R >> endobj
2 0 obj << /Type /Pages /Kids [ 3 0 R ] /Count 1 >> endobj
3 0 obj << /Type /Page /Parent 2 0 R /MediaBox [ 0 0 720 405 ]
  /Resources 4 0 R /Contents 5 0 R >> endobj
...
xref
0 6
0000000000 65535 f
0000000009 00000 n
0000000058 00000 n
0000000115 00000 n
0000000227 00000 n
0000000319 00000 n
```

この構造を見ると、Catalog -> Pages <-> Page -> コンテンツストリーム という流れが見えてきます。
Catalog がエントリポイントとなり、Pages が描画するページを探し、Page で実際のコンテンツをたどる流れです。

また、数字の羅列はクロスリファレンステーブルというもので、ファイル内の各オブジェクトの位置を一覧化した情報です。
例えば `0000000009 00000 n` という記述は、「このオブジェクトは PDF ファイルの 9 バイト目にある」ということを示しています。

この情報があることで、PDF の任意のページにランダムアクセスが可能になります。もしこの情報がなければ、目的のページにアクセスするために 1 ページ目から順に読む必要があるでしょう。
しかし、人間がこの計算を行うのは難しいため、DSL 側でオフセット計算をしながら PDF を組み立てる仕組みになっていました。

```ruby
class OffsetIO
  attr_reader :offset
  def initialize(io)
    @io = io
    @offset = 0
  end
  def <<(b)
    @io << b
    @offset += b.bytesize
  end
end

code do
  content <<~RUBY, style: JotPDF::Tokyork12::Highlighter::Ruby
    def obj
      @io << "obj "
      yield
      @io << " endobj"
    end
  RUBY
  list x: 350, y: 150, size: 25, color: 0xffffff do
    item "Ruby にはブロックがある"
  end
end
```

紹介のあったコードの一部を抜粋しましたが、`<<` メソッドを使ってクロスリファレンステーブルのバイトサイズを計算しつつ、content ブロック内で PDF の中身を組み立てる構造になっています。
ブロック構文を利用することで階層構造が視覚的に明確になり、code ブロックの中に content の内容や list の内容が含まれるという構図がわかりやすくなっています。

適度な粒度で抽象化されていく DSL の構築過程をとても楽しんで拝見しました。
業務で使っているツールなどをハックして再実装する試みは、そのツールとの機能差分を比較でき、より深い理解につながるので良いですよね！
私も何か Ruby で再実装できないかと考えさせられました。

さらに、発表のスライド自体もご自身が作った DSL で生成されていたというオチも素晴らしかったです（笑）。

(dak2)


### buty4649『mrubyでワンバイナリーなテキストフィルタツールを作った』

* 録画: https://example.com/

buty4649さんの発表ではテキストフィルタツールの[rf](https://github.com/buty4649/rf)について紹介されました！rfはsedやawk、jqのようなテキストフィルターツールと同じように、テキストデータの加工や整形、抽出を効率的に行えるツールです。rubyをインストールしていれば `echo matz | ruby -p -e '$_.tr! "a-z", "A-Z"'` のようにワンライナーでテキストの変換を実行することもできますが、よりタイプ数を減らして簡単に使えるツールが欲しい！！とのことでrfを開発されたそうです。mrubyを使ってワンバイナリーになっているのでrubyがなくてもインストールでき、Homebrewなどのパッケージマネージャーにも対応されています。 `brew install buty4649/tap/rf` でサクッとインストールできるので試してみてください！

rfではRuby実装を独自拡張しているところもあり、読み込んだ文字列を取得する `$_` を `_` で拡張してタイプ数を1文字減らしたり、変数を定義してなくても `s+=1` のように加算代入できるようにしたりと、テキストフィルターだからこそ必要な機能やこだわりポイントが紹介されていて面白かったです！また、後半はmrubyを使ったCLIツールの作り方も紹介してくださり、私自身mrubyを使ったことはなかったので学びが多かったです。

私もrfをインストールして使い始めましたがいいですね！`rf /include/ app/controllers/xxx.rb` みたいにrubyでrubyのコードを探すのは気持ちいいです！！テキストフィルターしたいんだけど、awkとかgrepとか毎回オプション忘れるし...正規表現の書き方も忘れるし...という方にはピッタリ合うツールだと思います！！

(三谷 昌平)


### morihirok『混沌とした例外処理とエラー監視に秩序をもたらす』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


### Kasumi Hanazuki『Ruby meets secure DNS and modern Internet protocols』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)


## 『Regional.rb and the Tokyo Metropolis』

* 録画: https://example.com/

レポート。レポート。レポート。レポート。レポート。

(your name)

## 会場や廊下のようす

### 体が足りないので廊下にいます

皆さんは物理カンファレンスに於いて重要視するのは何でしょうか。

トークでしょうか、トークでしょうね、トークだと思うんですが、そうではない人もいます。例えばそう、トークの最重要人物、スピーカーのひとびとですね。スピーカーのひとびとは、いま準備しているスライドで十分に伝わるか、きちんと人前で話せるか、時間配分は大丈夫か、とたくさんのことを考えて緊張していることが大半かと思います。スポンサーのひとびとは、自らのブースでどれくらいの人がどれくらい興味を持ってくれるだろうか、採用につながると嬉しいな、と考えて参加すると思います。それからオーガナイザーや当日スタッフのひとびとは、運営の様々なことを考えながら、ひとびとが楽しめるよう動いていると思います。

わたしはスポンサーブースの担当者を除く、参加者・スピーカー・当日スタッフ・オーガナイザーの各ロールで物理カンファレンスに参加したことがあります。スピーカーとして参加した時は、喋り始める直前に体が冷えて緊張に染まっていましたし、当日スタッフとして走り回るときはひとびとの導線を整理し続けていましたし、オーガナイザーとしてひとびとを迎え入れる際には、裏側で当日発生する「これどうしよう！」の対応をしたりしていました。一般参加者として参加するときは、たくさんの人と出会い、いろんな話をしていました。  

<img src="{{base}}{{site.baseurl}}/images/0065-TokyoRubyKaigi12Report/rouka_1.jpg" width="300px" alt="スポンサーブースとたむろする人々">


Rubyistとなって10年とちょっと、わたしがカンファレンスに於いて重要視するポイントは、「誰が参加していて、誰と話せるのか」になりました。誰が何を喋るのか、どこがスポンサーブースを出すのか等の一切合切を考えずに「誰が行くんだろう」がメインです。カンファレンスに於いて、人と会うこと、人と喋ること、人と知り合うことがわたしにとってのすべてです。東京Ruby会議12は、「誰が参加していて、誰と話せるのか」という視点に於いて期待値が高くありました。オーガナイザーチームの面々が主催するイベントで集まるひとびとは、きっと楽しく話せるであろう、あの人も来るかな、あの人は会えるかな、そんな期待とともに参加した東京Ruby会議12でした。  
<img src="{{base}}{{site.baseurl}}/images/0065-TokyoRubyKaigi12Report/rouka_2.jpg" width="300px" alt="受付やプリクラでワイワイする人々">

わたしは顔見知りから友人まで幅広く「あけましておめでとうございます。今年もよろしくお願いします」という切り口とともに沢山の話をしました。トークは基調講演をちらっと見たくらいで、ほとんどの時間を廊下で過ごしていました。スポンサーブースの中の人と話し込む時間もあれば、その場で話し込むことも、ホワイトボードを切欠に人と話すこともありました。ホワイトボードを中心に改行の話を始めるパーサー（に特に興味のあるRubyist）のひとびとを見てオーガナイザーのいかるがくんが「うわギャングだ」と称していたのをよく覚えています。（パーサーの人々はパーサーギャングと呼ばれています）  
<img src="{{base}}{{site.baseurl}}/images/0065-TokyoRubyKaigi12Report/rouka_3.jpg" width="300px" alt="ホワイトボードの前で交流する人々">

ひとびとと会う機会は、食事会や勉強会といった形で作れますが、カンファレンスは殊更特別です。平日夜の勉強会の参加は難しい、食事は家族と摂ることにしているなど、様々な制約があるひとびとがドンと集まるのです。たいていの友達には会えるし、友達の友達とも知り合える、限りなく身内的な閉じた空間でもあり、初めましての人とも出会える、開けた場所でもあるのです。  

Rubyistが一堂に会す機会は、RubyKaigiや地方Ruby会議など様々がありますが、東京Ruby会議12も同じくRubyistが集う場だったかと思います。  

皆さんは、誰とどんな話をしましたか？　  


(sakahukamaki)
